# Алгоритм сравнения белковых последовательностей с использованием числового представления

## Введение

Данный алгоритм предназначен для сравнения белковых последовательностей и поиска схожих последовательностей в базе данных [uniprot_sprot.fasta](uniprot_sprot.fasta) на основе их числового представления. Метод преобразует аминокислотные последовательности в числовые векторы и вычисляет евклидово расстояние между ними.

## Теоретическое обоснование

### Преобразование аминокислотных последовательностей в числовые векторы

Каждая аминокислота в последовательности кодируется числовым значением от 1 до 20 включительно согласно следующему отображению:

| Аминокислота | Числовое значение |
|--------------|-------------------|
| A            | 1                 |
| C            | 2                 |
| D            | 3                 |
| ...          | ...               |
| W            | 19                |
| Y            | 20                |

### Нормализация векторов

Полученный числовой вектор нормализуется с использованием L₂-нормы (евклидовой нормы):

$$
s_{\text{norm}} = \frac{s}{\|s\|}, \quad \text{где} \quad \|s\| = \sqrt{\sum_{i} s_i^2}
$$

Для сравнения последовательностей разной длины алгоритм дополняет более короткую последовательность нулями:

$$
s_{\text{padded}} = \text{pad}(s, (0, n - \text{len}(s)))
$$

где $n$ - длина более длинной последовательности.

### Метрика сходства

Расстояние между последовательностями вычисляется как евклидово расстояние между их нормализованными числовыми представлениями:

$$
\text{distance} = \|s_1 - s_2\|
$$

Меньшие значения этой метрики указывают на большее сходство между последовательностями.

## Практическая реализация

### Чтение и обработка данных

Алгоритм читает файлы в формате FASTA, содержащие белковые последовательности. Для каждой последовательности извлекается:

- Заголовок (идентификатор и описание)
- Аминокислотная последовательность

### Обработка последовательностей разной длины

Для сравнения последовательностей разной длины алгоритм:

1. Преобразует аминокислотные последовательности в числовые векторы
2. Нормализует векторы с использованием L₂-нормы
3. Дополняет более короткий вектор нулями до длины более длинного вектора
4. Вычисляет евклидово расстояние между векторами

### Поиск и ранжирование схожих последовательностей

Алгоритм сравнивает целевую последовательность со всеми последовательностями в базе данных, вычисляет метрику сходства для каждой пары и сортирует результаты по возрастанию значения метрики.


## Использование

1. Подготовьте файл в формате FASTA с последовательностями для сравнения
2. Запустите скрипт и введите целевую последовательность при запросе
3. Результаты будут сохранены в файл с указанием индекса, метрики сходства, длины и описания каждой последовательности

## Интерпретация результатов

- **Метрика близкая к 0**: Высокое сходство между последовательностями
- **Увеличение значения метрики**: Уменьшение степени сходства
- **Результаты сортируются** по возрастанию значения метрики, начиная с наиболее похожих последовательностей